import{_ as z,r as v,w as E,o as l,c as i,n as W,u as X,s as Y,a as R,N as T,b as ee,d as e,i as D,e as w,t as n,f as a,g as h,F as M,h as I,j as O,k as P,l as y,m as j,p as se,q as te,v as oe}from"./index-CxIGT_a7.js";import{g as ae,a as F,b as ne}from"./device-smEP7nMh.js";import{c as le}from"./index-DJjI7DKN.js";const ie=["id"],ce={__name:"CurrAmap",props:{device:{type:Object,default:()=>{}}},setup(x,{expose:B}){const c=v(null),f=v("");E(()=>x.device.sn,u=>{C()});const C=()=>{f.value=`AMap${new Date().getTime()}`,W(()=>{x.device.sn?V():c.value&&c.value.clearMap()})},V=()=>{ae({sn:x.device.sn}).then(u=>{var d,r;const g=(u==null?void 0:u.data)??"",b=((r=(d=JSON.parse(g))==null?void 0:d.point)==null?void 0:r.coordinates)??[],N='<div class="custom-content-marker"><img src="https://mhjy-public.obs.cn-south-1.myhuaweicloud.com:443/position.png"></div>';let _=new AMap.Marker({position:new AMap.LngLat(...b),content:N,offset:new AMap.Pixel(-15,-15)});_.on("click",()=>{c.value.setZoomAndCenter(18,location)}),c.value?(c.value.add(_),c.value.setZoomAndCenter(18,location)):(c.value=new AMap.Map(f.value,{resizeEnable:!0,center:b,zoom:18,mapStyle:"amap://styles/light"}),c.value.on("complete",function(){c.value.add(_)}))})};return B({initMap:C}),(u,g)=>(l(),i("div",{id:f.value,class:"map"},null,8,ie))}},de=z(ce,[["__scopeId","data-v-2ead57cb"]]),re={class:"g-content"},ue={class:"abs"},ve={class:"arc-box"},pe={class:"map-box"},me={key:0},_e={key:1},he={class:"user-list"},fe={class:"g-active-background"},ge={class:"f16"},be={class:"g-flex c66 m-t-15"},ke={class:"flex1"},we={class:"g-flex c66 m-t-5"},ye={class:"flex1"},xe={class:"flex1"},Ce={class:"g-flex c66 m-t-5"},Ve={class:"flex1"},Ne={class:"flex1"},Ae={class:"g-row-between c66 m-t-5"},De={class:"flex1"},Me={class:"tit m-t-20 g-row-between"},Be={class:"c33 g-row-between"},$e={class:"fs0"},Le={key:0,class:"g-tag b-green"},Te={key:1,class:"g-tag b-blue"},Ie={key:2,class:"g-tag b-green-light"},Pe={key:3,class:"g-tag b-gray"},Se=["onClick"],Ue={class:"c66 m-t-5"},Re={class:"c66 m-t-5"},Oe=["onClick"],je={class:"device-popup"},Fe={class:"pop-scroll"},ze=["onClick"],Ee={class:"device-popup"},He={class:"pop-scroll"},Ze=["onClick"],qe={__name:"home",setup(x){const B=te(),c=X(),{setUser:f}=c,{storePhone:C,storeUser:V}=Y(c),u=R(()=>V.value.id),g=R(()=>V.value.name),b=v([]);let N=v([]),_=v([]),d=v({}),r=v({bloodOxygenValue:"",bloodPressureValue:"",heartRateValue:"",sleepValue:"",stepNumberValue:"",time:""}),p=v(!1),m=v(!1);const H=()=>{oe({phone:C.value}).then(o=>{b.value=o.data}).finally(()=>{T.done()})},Z=()=>{F({elderId:u.value,elderType:0}).then(o=>{var s;N.value=o.data,d.value=((s=o.data)==null?void 0:s[0])??{}})},q=()=>{F({elderId:u.value}).then(o=>{_.value=o.data})},J=o=>{ne({sn:o}).then(s=>{r.value=s.data})},$=(o,s={})=>{B.push({name:o,params:s})},G=o=>{p.value=!1,f(o)},K=o=>{d.value=o,m.value=!1},S=()=>{H(),Z(),q()};return c.$subscribe((o,s)=>{T.start(),S()}),ee(()=>{T.start(),S()}),E(d,o=>{r.value={bloodOxygenValue:"",bloodPressureValue:"",heartRateValue:"",sleepValue:"",stepNumberValue:"",time:""},o.id&&J(o.sn)},{deep:!0,immediate:!0}),(o,s)=>{const A=P("van-icon"),Q=P("Tabbar"),U=P("van-popup");return l(),i(M,null,[e("div",re,[e("div",ue,[e("div",ve,[e("div",{onClick:s[0]||(s[0]=t=>D(p)?p.value=!0:p=!0),class:"c-white p-l-15 p-t-20 f16"},[w(n(g.value)+" ",1),s[6]||(s[6]=e("span",{class:"iconfont icon-arrdown"},null,-1))])]),e("div",pe,[e("div",{class:"map-tit",onClick:s[1]||(s[1]=t=>D(m)?m.value=!0:m=!0)},[a(d).deviceName?(l(),i("span",me,n(a(d).deviceName),1)):(l(),i("span",_e,"选择设备")),s[7]||(s[7]=e("span",{class:"iconfont icon-arrdown m-l-5"},null,-1))]),e("div",{class:"map-list c-white",onClick:s[2]||(s[2]=t=>$("locations",{sn:a(d).sn}))},[s[8]||(s[8]=w(" 定位记录 ")),h(A,{name:"arrow"})]),h(de,{ref:"refAmap",device:a(d)},null,8,["device"])])]),e("div",he,[s[12]||(s[12]=e("div",{class:"tit"},"健康信息",-1)),e("div",fe,[e("div",ge,n(g.value),1),e("div",be,[s[9]||(s[9]=e("div",{class:"flex1"},"体温：无字段",-1)),e("div",ke,"睡眠： "+n(a(r).sleepValue),1)]),e("div",we,[e("div",ye,"血压： "+n(a(r).bloodPressureValue),1),e("div",xe,"心率： "+n(a(r).heartRateValue)+"次/分",1)]),e("div",Ce,[e("div",Ve,"血氧： "+n(a(r).bloodOxygenValue),1),e("div",Ne,"步数："+n(a(r).stepNumberValue)+"步",1)]),e("div",Ae,[e("div",De,"检测时间："+n(a(r).time),1),e("div",{class:"fs0 c-green-light",onClick:s[3]||(s[3]=t=>$("health",{sn:a(d).sn}))},[s[10]||(s[10]=w("查看详情")),h(A,{name:"arrow"})])])]),e("div",Me,[s[11]||(s[11]=e("div",null,"设备信息",-1)),e("div",null,"设备数："+n(a(_).length),1)]),(l(!0),i(M,null,I(a(_),(t,k)=>(l(),i("div",{class:"shadow-card",key:k},[e("div",Be,[e("div",null,"设备名称："+n(t.deviceName),1),e("div",$e,[t.deviceBusiness==="平安通设备"?(l(),i("span",Le,"平安通")):y("",!0),t.deviceBusiness==="居家设备"?(l(),i("span",Te,"居家")):y("",!0),t.online==="true"?(l(),i("span",Ie,"在线")):y("",!0),t.online==="false"?(l(),i("span",Pe,"下线")):y("",!0)])]),e("div",{class:"c66 m-t-15",onClick:L=>a(le)(t.sn)},"设备SN/ID："+n(t.sn),9,Se),e("div",Ue,"绑定时间： "+n(t.createTime),1),e("div",Re,"绑定人： "+n(t.createBy),1),e("div",{class:"g-btn m-t-20",onClick:L=>$("alert",{sn:t.sn})},"告警信息",8,Oe)]))),128))])]),h(Q),h(U,{show:a(m),"onUpdate:show":s[4]||(s[4]=t=>D(m)?m.value=t:m=t),position:"bottom",style:{height:"60vh"},closeable:"","close-icon":"close",round:"","safe-area-inset-bottom":""},{default:O(()=>[e("div",je,[s[13]||(s[13]=e("div",{class:"f18 g-flex pop-tit"},"选择设备",-1)),e("div",Fe,[(l(!0),i(M,null,I(a(N),(t,k)=>(l(),i("div",{class:j(["pop-item f16",{"c-green":a(d).id==t.id}]),key:k,onClick:L=>K(t)},[w(n(t.deviceName)+" ",1),h(A,{class:"m-l-10",name:"success",color:"#239959"})],10,ze))),128))])])]),_:1},8,["show"]),h(U,{show:a(p),"onUpdate:show":s[5]||(s[5]=t=>D(p)?p.value=t:p=t),position:"bottom",style:{height:"60vh"},closeable:"","close-icon":"close",round:"","safe-area-inset-bottom":""},{default:O(()=>[e("div",Ee,[s[14]||(s[14]=e("div",{class:"f18 g-flex pop-tit"},"选择长者",-1)),e("div",He,[(l(!0),i(M,null,I(b.value,(t,k)=>(l(),i("div",{class:j(["pop-item f16",{"c-green":u.value==t.id}]),key:k,onClick:L=>G(t)},[w(n(t.name)+" ",1),u.value==t.id?(l(),se(A,{key:0,class:"m-l-10",name:"success",color:"#239959"})):y("",!0)],10,Ze))),128))])])]),_:1},8,["show"])],64)}}},Qe=z(qe,[["__scopeId","data-v-be341ef6"]]);export{Qe as default};
