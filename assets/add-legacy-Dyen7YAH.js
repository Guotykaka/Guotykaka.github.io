System.register(["./index-legacy-oZhpELhF.js","./index-legacy-CL91mC_T.js"],(function(e,l){"use strict";var t,a,o,n,r,i,u,d,c,s,v,m,p,g,h,b,f,x,V,w;return{setters:[e=>{t=e._,a=e.r,o=e.u,n=e.s,r=e.b,i=e.x,u=e.d,d=e.c,c=e.e,s=e.h,v=e.k,m=e.B,p=e.l,g=e.o,h=e.g,b=e.v,f=e.C},e=>{x=e.a,V=e.b,w=e.s}],execute:function(){var l=document.createElement("style");function y(e,l=!1){if(e){var t=new Date(e),a=t.getFullYear(),o=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,n=t.getDate()<10?"0"+t.getDate():t.getDate(),r=t.getHours()<10?"0"+t.getHours():t.getHours(),i=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),u=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return l?a+"-"+o+"-"+n:a+"-"+o+"-"+n+" "+r+":"+i+":"+u}return""}l.textContent=".g-content[data-v-0cc294c1]{height:var(--viewport-height-mini);padding-bottom:50px;position:relative}.g-content .marginBottom10[data-v-0cc294c1]{margin-bottom:10px}.g-content .footer-btn-box[data-v-0cc294c1]{width:100%;position:fixed;bottom:50px;left:0;background:#fff;padding-top:10px}.g-content .footer-btn-box .add-btn[data-v-0cc294c1]{margin:0 20px 20px;height:40px;line-height:40px;text-align:center;border:1px solid var(--primary);background:var(--primary-bg);color:var(--primary);border-radius:8px;font-size:14px}\n",document.head.appendChild(l);const C={class:"g-content"},k={class:"footer-btn-box"};e("default",t({__name:"add",setup(e){const l=b(),t=a(""),N=[],U=a([]),_=a(!1);a([]),a(!1),a(!1);const D=a(""),M=a(!1),T=a(!1),B=a(new Date),I=o(),{storeUser:q}=n(I),L=r((()=>q.value.id)),P=i({clientName:q.value.name,reportPhone:q.value.curPhone,deviceNo:"",deviceName:"",deviceModel:"",phone:null,elderId:L.value,customerType:null,reportAddress:null,description:null,visitTime:null,source:"用户",recordPerson:q.value.curName,createBy:q.value.curName,createById:q.value.curUserId}),S=()=>{_.value=!0},A=e=>{if(t.value=e.selectedOptions[0].text,_.value=!1,e.selectedValues<0)return;let l=e.selectedValues[0];N.value.map((e=>{e.id==l&&(P.deviceName=e.deviceName,P.deviceModel=e.deviceModel,P.deviceNo=e.sn)}))},H=()=>{M.value=!0},O=e=>{D.value=e.selectedOptions[0].text,P.troubleType=e.selectedOptions[0].value,M.value=!1},j=()=>{T.value=!0},E=e=>{P.visitTime=e.selectedValues[0]+"-"+e.selectedValues[1]+"-"+e.selectedValues[2],T.value=!1},F=()=>{Boolean(t.value)?Boolean(D.value)?(console.log(P,P.value,0xa1b01d4b1c7),w({...P,reportTime:y(new Date)}).then((e=>{f("操作成功"),l.push("/repair")})).catch((e=>{f(e.msg)}))):f("请选择故障类型"):f("请选择设备")};return u((()=>{x({elderId:L.value}).then((e=>{console.log("🚀 ~ fetchDeviceList ~ res:",e),N.value=e.data??[];let l=[];e.data.forEach((e=>{l.push({text:e.deviceName,value:e.id})})),l.unshift({text:"无设备",value:-1}),console.log("🚀 ~ fetchDeviceList ~ arr:",l),U.value=l,console.log("🚀 ~ fetchDeviceList ~ deviceTypeList:",U.value)}))})),(e,l)=>{const a=p("van-field"),o=p("van-cell-group"),n=p("van-form"),r=p("van-picker"),i=p("van-popup"),u=p("van-date-picker");return g(),d("div",C,[c("div",null,[s(n,{ref:"submitForm","input-align":"right","error-message-align":"right"},{default:v((()=>[s(o,{title:"基础信息",class:"marginBottom10"},{default:v((()=>[s(a,{readonly:"",required:"",name:"deviceNo",modelValue:t.value,"onUpdate:modelValue":l[0]||(l[0]=e=>t.value=e),label:"选择设备",placeholder:"","right-icon":"arrow",onClick:S,rules:[{required:!0,message:"请选择设备"}]},null,8,["modelValue"]),s(a,{readonly:"",required:"",clickable:"",modelValue:D.value,"onUpdate:modelValue":l[1]||(l[1]=e=>D.value=e),label:"故障类型",placeholder:"",onClick:H,"right-icon":"arrow",rules:[{required:!0,message:"请选择故障类型"}]},null,8,["modelValue"]),s(a,{modelValue:P.reportAddress,"onUpdate:modelValue":l[2]||(l[2]=e=>P.reportAddress=e),label:"报障地址",placeholder:"请输入"},null,8,["modelValue"]),s(a,{modelValue:P.description,"onUpdate:modelValue":l[3]||(l[3]=e=>P.description=e),label:"故障描述",placeholder:"请输入"},null,8,["modelValue"]),s(a,{readonly:"",name:"datetimePicker",modelValue:P.visitTime,"onUpdate:modelValue":l[4]||(l[4]=e=>P.visitTime=e),label:"计划上门时间",placeholder:"",onClick:j,"right-icon":"arrow"},null,8,["modelValue"])])),_:1})])),_:1},512),s(i,{show:_.value,"onUpdate:show":l[6]||(l[6]=e=>_.value=e),position:"bottom"},{default:v((()=>[s(r,{"show-toolbar":"",columns:U.value,onConfirm:A,onCancel:l[5]||(l[5]=e=>_.value=!1)},null,8,["columns"])])),_:1},8,["show"]),s(i,{show:M.value,"onUpdate:show":l[8]||(l[8]=e=>M.value=e),position:"bottom"},{default:v((()=>[s(r,{"show-toolbar":"",columns:h(V),onConfirm:O,onCancel:l[7]||(l[7]=e=>M.value=!1)},null,8,["columns"])])),_:1},8,["show"]),s(i,{show:T.value,"onUpdate:show":l[10]||(l[10]=e=>T.value=e),position:"bottom"},{default:v((()=>[s(u,{value:P.visitTime,type:"day","min-date":B.value,onConfirm:E,onCancel:l[9]||(l[9]=e=>T.value=!1)},null,8,["value","min-date"])])),_:1},8,["show"])]),c("div",k,[c("div",{class:"add-btn",onClick:m(F,["stop"])},"确定")])])}}},[["__scopeId","data-v-0cc294c1"]]))}}}));
